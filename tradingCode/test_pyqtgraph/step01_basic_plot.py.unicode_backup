"""
Step 1: Create basic plot widget with visible axes
Goal: Empty white background with clearly visible axes and labels
"""

import sys
import numpy as np
import pyqtgraph as pg
from PyQt5 import QtWidgets, QtCore, QtGui

def save_widget_screenshot(widget, filename):
    """Save a screenshot of the widget"""
    try:
        pixmap = widget.grab()
        success = pixmap.save(filename, 'PNG')
        print(f"Screenshot saved: {filename} (Success: {success})")
        return success
    except Exception as e:
        print(f"Error saving screenshot: {e}")
        return False

class BasicPlotWidget(pg.PlotWidget):
    def __init__(self):
        super().__init__()
        
        # Set white background
        self.setBackground('white')
        
        # Set axis labels
        self.setLabel('left', 'Price ($)', color='black', size='14pt')
        self.setLabel('right', 'Price ($)', color='black', size='14pt')
        self.setLabel('bottom', 'Time (bars)', color='black', size='14pt')
        self.setLabel('top', 'Trading Chart', color='black', size='16pt')
        
        # Configure all axes for maximum visibility
        for axis_name in ['left', 'right', 'bottom', 'top']:
            self.showAxis(axis_name, True)
            axis = self.getAxis(axis_name)
            if axis:
                # Thick black axes
                axis.setPen(pg.mkPen('black', width=3))
                axis.setTextPen(pg.mkPen('black', width=2))
                axis.setStyle(showValues=True, tickLength=10)
                
                # Set appropriate dimensions
                if axis_name in ['left', 'right']:
                    axis.setWidth(100)
                else:
                    axis.setHeight(60)
                
                axis.show()
        
        # Set initial ranges to show numbered axes
        self.setXRange(0, 100)
        self.setYRange(0, 200)
        
        print("Step 1: Basic plot widget created with visible axes")

def test_step1():
    """Test Step 1: Basic plot widget"""
    
    app = QtWidgets.QApplication.instance()
    if app is None:
        app = QtWidgets.QApplication(sys.argv)
    
    # Create window
    win = QtWidgets.QMainWindow()
    win.setWindowTitle("Step 1: Basic Plot Widget with Visible Axes")
    win.resize(1000, 700)
    
    # Create basic plot widget
    plot_widget = BasicPlotWidget()
    win.setCentralWidget(plot_widget)
    
    # Show window
    win.show()
    win.raise_()
    win.activateWindow()
    
    # Process events to ensure rendering
    for i in range(10):
        app.processEvents()
        QtCore.QThread.msleep(100)
    
    # Save screenshot
    save_widget_screenshot(win, "step01_basic_plot_result.png")
    
    print("\n=== STEP 1 VERIFICATION ===")
    print("Required elements to verify in screenshot:")
    print("✓ White background")
    print("✓ Black axis lines on all sides (left, right, bottom, top)")
    print("✓ Axis labels: 'Price ($)' on Y-axes, 'Time (bars)' on X-axis")
    print("✓ 'Trading Chart' title at top")
    print("✓ Numerical tick marks and values on axes")
    print("✓ X-axis range: 0-100, Y-axis range: 0-200")
    print("\nCheck step01_basic_plot_result.png for verification")
    
    return app, win

if __name__ == "__main__":
    app, win = test_step1()
    
    # Keep open for inspection
    QtCore.QTimer.singleShot(8000, app.quit)
    app.exec_()